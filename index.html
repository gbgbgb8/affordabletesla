<!DOCTYPE html>
<html lang="en" data-theme="dark">

<head>
    <meta charset="UTF-8">
    <title>Tesla is Affordable!</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/picocss/1.5.10/pico.min.css" integrity="sha512-R4D8tIuJws1QxZAVEpeFxtKEw4iab4HuyVzofpiO19VmlBhXW5qdTCmD/+yYQ+nviYUgS2EywDnoNTaj+lpUfA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <style>
        .theme-switcher {
            position: fixed;
            right: 20px;
            bottom: 20px;
        }
    </style>
</head>

<body>
    <main class="container">
        <header>
            <h1>Tesla Affordability Calculator</h1>
            <p id="summaryStatement">The total cost of this Tesla after <span id="yearsValue">X</span> years of fuel savings and <span id="totalCreditsValue">Y</span> Federal/State/Referral credits is: <span id="totalValue">Z</span></p>
        </header>
        <section>
            <form id="tesla-calculator">
                <div class="grid">
                    <div>
                        <label for="carPrice" data-tooltip="This is the base vehicle price from Tesla.">Car Price:</label>
                        <input type="number" id="carPrice" name="carPrice" value="40240" required>
                        <label for="federalCredit" data-tooltip="Customers who take delivery of a qualified new Tesla and meet all federal requirements are eligible for a tax credit up to $7,500. Reductions likely after Dec 31.">Federal Credit:</label>
                        <input type="number" id="federalCredit" name="federalCredit" value="-7500" required>
                        <label for="referralCredit" data-tooltip="Order Tesla products through a Referral Link to earn up to $500 off your order, plus 3 months of Full Self-Driving Capability">Ref. Credit:</label>
                        <input type="number" id="referralCredit" name="referralCredit" value="-500" required>
                        <label for="destinationFee" data-tooltip="Taxes and fees listed are estimates only, subject to change, and may not be accurate to you, depending on factors like your registration location. Your applicable taxes and fees will be confirmed for you closer to time of delivery.">Dest. Fee:</label>
                        <input type="number" id="destinationFee" name="destinationFee" value="1390" required>
                    </div>
                    <div>
                        <label for="years" data-tooltip="Average duration of ownership of a new vehicle is 8 years. How long do you think you will own this car?">Years:</label>
                        <select id="years" name="years">
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8" selected>8</option>
                            <option value="9">9</option>
                            <option value="10">10</option>
                        </select>
                        <label for="milesPerYear" data-tooltip="How many miles will you drive per year? National average is around 14-15K per year.">Miles/Year:</label>
                        <input type="number" id="milesPerYear" name="milesPerYear" value="15000" required>
                        <label for="gasPrice" data-tooltip="How much is a gallon of gas in your area?">Gas/Gallon:</label>
                        <input type="number" id="gasPrice" name="gasPrice" value="5.29" required>
                        <label for="mpg" data-tooltip="The national average MPG is around 25 MPG, adjust as needed.">MPG:</label>
                        <input type="number" id="mpg" name="mpg" value="25" required>
                    </div>
                </div>
            </form>
        </section>
        <section>
            <div class="summary">
                <h2>Quick Summary</h2>
                <table>
                    <thead>
                        <tr>
                            <th scope="col">Description</th>
                            <th scope="col">Amount</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>Initial Cost:</td>
                            <td><span id="initialCost">-</span></td>
                        </tr>
                        <tr>
                            <td>Fuel Savings:</td>
                            <td><span id="initialFuelSavings">-</span></td>
                        </tr>
                        <tr>
                            <td>Final Cost:</td>
                            <td><span id="resultingCost">-</span></td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>
    <div class="theme-switcher">
        <fieldset>
            <label>
                Dark Mode:
                <input type="checkbox" role="switch" checked onchange="toggleTheme()">
            </label>
        </fieldset>
    </div>
    <script>
        function updateStatement() {
            const years = document.getElementById('years').value;
            const federalCredit = document.getElementById('federalCredit').value;
            const referralCredit = document.getElementById('referralCredit').value;
            const totalCredits = parseFloat(federalCredit) + parseFloat(referralCredit);

            document.getElementById('yearsValue').textContent = years;
            document.getElementById('totalCreditsValue').textContent = "$" + Math.abs(totalCredits).toFixed(2);
        }

        function calculateTotal() {
            updateStatement();

            const initialCost = calculateAffordability();
            const initialFuelSavings = calculateFuelSavings();
            const resultingCost = initialCost - initialFuelSavings;

            document.getElementById('initialCost').innerText = "$" + initialCost.toFixed(2);
            document.getElementById('initialFuelSavings').innerText = "$" + initialFuelSavings.toFixed(2);
            document.getElementById('resultingCost').innerText = "$" + resultingCost.toFixed(2);
            document.getElementById('totalValue').textContent = "$" + resultingCost.toFixed(2);
        }

        function calculateAffordability() {
            const carPrice = parseFloat(document.getElementById('carPrice').value);
            const federalCredit = parseFloat(document.getElementById('federalCredit').value);
            const referralCredit = parseFloat(document.getElementById('referralCredit').value);
            const destinationFee = parseFloat(document.getElementById('destinationFee').value);

            return carPrice + federalCredit + referralCredit + destinationFee;
        }

        function calculateFuelSavings() {
            const years = parseFloat(document.getElementById('years').value);
            const milesPerYear = parseFloat(document.getElementById('milesPerYear').value);
            const gasPrice = parseFloat(document.getElementById('gasPrice').value);
            const mpg = parseFloat(document.getElementById('mpg').value);

            const totalMiles = years * milesPerYear;
            const totalGallons = totalMiles / mpg;

            return totalGallons * gasPrice;
        }

        function toggleTheme() {
            const theme = document.documentElement.getAttribute('data-theme');
            if (theme === 'dark') {
                document.documentElement.setAttribute('data-theme', 'light');
            } else {
                document.documentElement.setAttribute('data-theme', 'dark');
            }
        }

        window.onload = function() {
            const inputs = document.querySelectorAll('input, select');
            for (let input of inputs) {
                input.addEventListener('input', function() {
                    updateStatement();
                    calculateTotal();
                });
            }
            updateStatement();
            calculateTotal();
        }
    </script>
</body>

</html>
